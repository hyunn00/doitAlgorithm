# Chapter05 재귀 알고리즘 - 04 8퀸 문제
- 이 문제는 하노이의 탑과 마찬가지로 작은 문제로 나누어 해결함

<br>

## 8퀸 문제란?
- 8퀸 문제(8-Queen Problem)는 재귀 알고리즘을 깊이 이해하기 위한 예제로 자주 등장할 뿐만 아니라 19세기의 유명한 수학자 카를 포리드리히 가우스(C.F.Gauss)가 잘못된 해답을 내놓은 것으로도 잘 알려졌다.
- 이 문제는 다음과 같다.
  ```
  서로 공격하여 잡을 수 없도록 8개의 퀸을 8x8 체스판에 놓으세요.
  ```
  - 언뜻 보면 간단한 문제처럼 보인다.
  - 체스판에서 퀸은 현재 놓여 있는 지점에서 가로, 세로, 대각선의 8가지 방향으로 직선 이동을 할 수 있음
- 이 문제의 답이 되는 조합은 92가지 이다.

<br>

---

<br>

## 퀸 배치하기
- 8개의 퀸을 배치하는 조합은 64 x 63 x 62 x 61 x 60 x 59 x 58 x 57 가지이다.
- 그런데 이 조합을 모두 나열하고 각각의 조합이 8퀸 문제의 조건을 만족하는 지는 현실적이지 않다.
- 퀸은 자신과 같은 열에 있는 다른 퀸을 공격할 수 있으므로 다음과 같은 규칙을 세울 수 있다.
  ```
  [규칙 1] 각 열에 퀸을 1개만 배치합니다.
  ```
- 이렇게 하면 퀸을 배치하는 조합의 수는 8 x 8 x 8 x 8 x 8 x 8 x 8 x 8가지로 많이 줄어들지만, 여전히 그 수는 지나치게 많다.
- 퀸은 자신과 같은 행에 있는 다른 행에 있는 다른 퀸을 공격할 수 있기 때문에, 다음 규칙을 추가하겠다.
  ```
  [규칙 2] 각 행에 퀸을 1개만 배치합니다.
  ```
- 이렇게 하면 이 조합을 나열하는 알고리즘을 어떻게든 만들 수 있으나 그렇게 간단히 만들어지지는 않는다.

<br>

---

<br>

## 분기 조작
- 분기란 가지가 뻗어나가듯이 문제로 나누어 푸는 과정을 의미함
- QueenB
  - 배열 pos는 퀸의 배치를 나타냄
    - i 열에 놓인 퀸의 위치가 j행이면 pos[i]의 값을 j로 함
  - set 메서드는 pos[i]에 0부터 7까지의 값을 순서대로 대입하여 'i열에 퀸을 1개만 배치하는 8가지 조합을 만드는 재귀 메서드'
    - 매개변수 i가 이 퀸을 배치할 열
  - main 메서드에서 호출될 set 메서드는 매개변수 i에 0을 전달받기 때문에 0열에 퀸 1개를 배치
  - for 문 반복을 통해 j 행을 0부터 7까지 1씩 증가시키면서 pos[i]에 j를 대입하는 것으로 퀸을 j 행에 배치
  - 이 대입에서 0 열이 확정되고 다음으로 1열을 확정해야 함
  - set(i + 1)에 의해 앞에서 했던 작업을 다음 열인 1열에 대해 수행
- 이렇게 분기하여 퀸을 배치하는 조합을 모두 나열함, 이러한 방법을 분기 조작 또는 가지 뻗기(branching)라고 함
- 하노이의 탑이나 8퀸 문제처럼 문제를 작게 나누고 세분된 작은 문제의 풀이를 결합해 전체 문제를 풀이하는 기법을 분할 정복법(divide and conquer method)라고 함
- 물론 문제를 작게 나눌 때는 작은 문제의 풀이에서 원래 문제의 풀이가 쉽게 도출될 수 있도록 설계해야 함

<br>

---

<br>

## 분기 한정법
- 분기 조작으로 퀸을 배치하는 조합을 나열할 수 는 있지만 8퀸 문제의 답을 구할 수 는 없음
- QueenBB
  - 이 프로그램은 flag라는 배열을 사용함
    - flag는 같은 행에 중복하여 퀸을 배치되는 것을 방지하기 위한 표시(flag)
    - j 행에 퀸을 배치하면 flag[j]의 값을 true로 하고, 배치되지 않은 상태값은 false로 함
  - 재귀 호출한 set(i+1) 메서드 실행이 끝나면 퀸을 j 행에서 제거하기 위해 flag[j]에 아직 배치하지 않았음을 나타내는 false를 대입함
  - set 메서드에서는 퀸을 아직 배치하지 않은 행에만 퀸을 배치함
- 이처럼 필요하지 않은 분기를 없애 불필요한 조합을 줄이는 방법을 한정(bounding) 조작이라 하고, 분기 조작과 한정 조작을 조합하여 문제를 풀어가는 방법을 분기 한정법(branching and bounding method)이라고 함

<br>

---

<br>

## 8퀸 문제를 해결하는 프로그램 만들기
- QueenBB 프로그램은 퀸이 행 방향과 열 방향으로 겹쳐지지 않은 조합을 나열(출력)하기만 함
- 이는 사실 '8퀸 문제를 푼 것'이 아니라 '8룩(Rook) 문제를 푼 것'
- 퀸은 대각선 방향으로도 이동할 수 있기 때문에 어떤 대각선에서 보더라도 퀸을 1개만 배치하는 한정 조작을 추가해야 함
- EightQueen
  - flag_b와 flag_c는 / 대각선 방향, \ 대각선 방향 중 어느 하나라도 이미 퀸이 배치되었다면 그 칸에는 퀸을 놓을 필요가 없음

<br>

---

<br>

정리한 내용에 대한 저작권은 "[do it! 자료구조와 함께 배우는 알고리즘 입문 자바편 개정](https://www.aladin.co.kr/search/wsearchresult.aspx?SearchTarget=All&SearchWord=Do+it%21+%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0%EC%99%80+%ED%95%A8%EA%BB%98+%EB%B0%B0%EC%9A%B0%EB%8A%94+%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98+%EC%9E%85%EB%AC%B8+%3A+%EC%9E%90%EB%B0%94+%ED%8E%B8)"에 있습니다.